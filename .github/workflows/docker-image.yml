name: Docker Image CI
on:
  workflow_run:
    workflows: ["Provision Infrastructure"]
    types:
      - completed

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Print Docker build directory
      run: |
        echo "Docker build directory: $(pwd)"
        ls -al
        
    - name: Build the Docker image
      run: |
        docker build . --file Docker/Dockerfile --tag my-image-name
        docker save my-image-name -o my-image-name.tar

    - name: Debug - List files in current directory
      run: ls -al

    - name: Debug - Display file size of the tarball
      run: du -h my-image-name.tar

    - name: Debug - Display content of the tarball
      run: tar -tvf my-image-name.tar